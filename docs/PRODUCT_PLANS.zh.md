# HSK Staking 产品方案

## 一. 产品概览

本方案基于 Whale Staking 合约架构，为所有用户提供单一质押池：

- **HSK Staking**：单一池子，对所有用户开放，稳定收益

---

## 二. 产品配置

### 产品定位
面向所有用户的单一质押池产品，提供稳定的质押收益，参与门槛低。

### 目标用户
- 所有用户（默认无需白名单）
- 零售投资者
- 小额和大额资金持有者
- 希望获得稳定收益的用户

### 核心参数

| 参数项 | 配置值 | 说明 |
|-----------|---------------|-------|
| **最小质押门槛** | 1 HSK | 用户每次质押的最低金额 |
| **基础年化收益率** | 5% | 基础 APY（合约实时结算） |
| **总预期年化** | Up to 8% | 前端展示（包含忠诚度补贴 1%-3%） |
| **锁定期** | 365 天 | 固定 365 天锁定期 |
| **白名单模式** | 默认禁用 | 所有用户可以自由参与质押 |
| **最大总质押量** | 30,000,000 HSK | 整个产品池的上限（所有用户质押金额总和的上限，非单笔限制） |
| **质押窗口期** | 约 7 天 | 只能在指定的时间窗口内质押 |

### 产品机制

#### 1. 参与机制
- **开放参与**：无需审核，任何用户都可以参与质押（默认禁用白名单）
- **质押时间窗口**：约 7 天，只能在指定的时间窗口内进行质押（由管理员设置开始时间和结束时间）
- **固定锁定期**：锁定期固定为 365 天（不需要选择）
- **多次质押**：同一用户可以进行多次质押，创建多个质押位置

#### 2. 收益机制
- **基础年化收益率**：5% 基础 APY（合约实时结算）
- **总预期年化**：Up to 8%（前端展示，包含忠诚度补贴 1%-3%）
- **忠诚度补贴**：1%-3%（链下发放，不在合约中）
  - ≥ 1 个月且 < 6 个月：+1% APY
  - ≥ 6 个月且 < 12 个月：+2% APY
  - 12 个月（完整 365 天）：+3% APY
  - **分配机制**：Staking 活动结束后，根据持仓用户在 staking 总数的占比，等比例一次性分配给质押完整的用户（完成完整质押周期 365 天）
- **按秒计息**：奖励按实际质押秒数连续累积，精确到秒
- **奖励上限**：奖励只计算到锁定期结束，超期质押不会增加奖励

#### 3. 提取机制

**解锁规则**：
- **锁定期限制**：锁定期内（365 天）不能解除质押，只能提取奖励
- **解锁条件**：锁定期结束后（365 天后）才能解除质押
- **解锁时间计算**：解锁时间 = 质押时间 + 365 天（例如：2026-11-01 质押，解锁时间 2027-11-01）

**提取方式**：
1. **奖励提取**（锁定期内）：
   - 可以随时提取已累积的奖励
   - 提取奖励后，质押位置仍然保留
   - 本金继续锁定，继续获得奖励

2. **提前解除质押**（锁定期内）：
   - 锁定期内可以申请提前解除质押
   - 申请后必须等待 7 天才能完成
   - 罚金：50% 的收益被罚没（转入罚金池）
   - 收益计算到申请时间，不是完成时间
   - 如果用户已领取超过 50% 的收益，超出部分从本金扣除

3. **解除质押**（锁定期结束后）：
   - 锁定期结束后，可以解除质押
   - 解除质押时，自动提取本金 + 全部累积奖励
   - 解除质押后，该质押位置关闭，不再获得奖励

4. **紧急提取**（特殊情况下）：
   - 仅在管理员启用紧急模式时可用
   - 可以随时提取，不受锁定期限制
   - 只能提取本金，放弃全部奖励

**提取金额**：
- **奖励提取**：仅提取已累积的奖励金额
- **提前解除质押**：本金 + 50% 的收益（50% 罚金转入罚金池）
- **解除质押**：本金 + 全部累积奖励（包括未提取的奖励）
- **紧急提取**：仅本金，不包含奖励

#### 4. 风险控制
- **最小质押门槛**：设置合理的参与门槛（单笔质押的最低金额）
- **最大总质押量限制**：整个产品池的上限（所有用户质押金额总和的上限），防止过度集中，确保系统稳定
- **奖励池余额检查**：合约会检查奖励池余额是否足够支付所有待发放奖励，确保系统稳定
- **紧急提取机制**：特殊情况下管理员可启用紧急模式，用户可随时提取本金（放弃奖励）

### 适用场景
✅ 适合长期持有 HSK 的用户  
✅ 希望获得稳定收益的投资者  
✅ 小额资金参与质押  
✅ 不需要高收益但追求稳健的用户  

### 运营建议
- **推广策略**：强调低门槛、稳定收益，吸引普通用户参与
- **用户教育**：重点说明锁定期和收益计算方式
- **奖励池管理**：需要定期向奖励池充值，确保有足够资金支付奖励

---

## 三. 罚金池分配机制

### 罚金池来源
- 所有提前解除质押的罚金（50% 的收益）进入罚金池
- 罚金池在合约中累积

### 分配规则
- **分配时间**：Staking 活动结束后，所有质押都到期之后
- **分配方式**：链下统计，一次性分配
- **分配规则**：根据持仓用户在 staking 总数的占比，等比例分配
- **分配条件**：只有完成完整质押周期（365 天）的用户才能获得
- **提前解除质押用户**：不能获得罚金池分配

### 示例
- 罚金池总额：100,000 HSK
- 用户A质押：1,000,000 HSK（完成完整 365 天）
- 用户B质押：500,000 HSK（完成完整 365 天）
- 总完整质押：10,000,000 HSK
- 用户A分配：100,000 × (1,000,000 / 10,000,000) = 10,000 HSK
- 用户B分配：100,000 × (500,000 / 10,000,000) = 5,000 HSK

---

## 四. 重要机制说明

### 1. 解锁机制

**核心规则**：
- **锁定期内**：不能解除质押，只能提取奖励
- **锁定期结束后**：可以解除质押，提取本金 + 全部奖励
- **解锁时间**：解锁时间 = 质押时间 + 锁定期

**解锁条件**：
- 必须等待锁定期完全结束
- 锁定期内可以申请提前解除质押（需支付罚金）
- 锁定期结束后可以随时解除质押（无时间限制）

**示例**：
- 用户在 2026-11-01 00:00:00 质押，固定 365 天锁定期
- 解锁时间：2027-11-01 00:00:00（365 天后）
- 锁定期内（2026-11-01 至 2027-11-01）：只能提取奖励，可以申请提前解除质押
- 锁定期结束后（2027-11-01 之后）：可以解除质押，提取本金 + 全部奖励

**运营意义**：
- 确保资金锁定，避免用户过早退出
- 保护质押机制的有效性
- 鼓励用户长期持有

### 2. 收益计算机制

**核心规则**：收益只计算到锁定期结束

**示例**：
- 用户选择 365 天锁定期，5% 年化收益率
- 实际质押了 400 天才提取
- 收益仍按 365 天计算：`本金 × 5% × (365/365) = 本金 × 5%`
- **重要**：超过锁定期的时间不会产生额外收益，收益只计算到锁定期结束

**运营意义**：
- 鼓励用户按时提取，避免资金长期占用
- 提高资金周转效率
- 确保奖励池资金充足

### 3. 白名单机制

**配置**：
- 白名单模式：默认禁用
- 所有用户可以自由参与
- 无需审核
- 管理员可以按需启用白名单模式

**运营建议**：
- 如果启用白名单，建立白名单审核标准
- 定期审查白名单用户
- 及时添加/移除白名单用户

### 4. 奖励池管理

**奖励池要求**：
- 基于 5% 基础 APY 计算所需奖励
- 需要充足的奖励池资金支持
- 合约在允许新质押前检查奖励池余额是否充足

**运营建议**：
- 定期检查奖励池余额
- 确保有足够资金支付固定年化奖励（5% 基础 APY）
- 提前规划奖励池充值计划

### 5. 紧急提取机制

**机制概述**：
- 紧急提取是特殊情况下的提取方式
- 仅在管理员启用紧急模式后可用
- 允许用户在锁定期内提取本金，但放弃所有奖励

**触发条件**：
- 管理员必须启用紧急模式
- 启用紧急模式后，用户可以随时使用紧急提取功能

**功能说明**：
- **紧急提取**：
  - 不受锁定期限制，可以随时提取
  - 只能提取本金，不包括奖励
  - 提取后质押位置关闭

- **紧急模式下的其他限制**：
  - 奖励分发暂停
  - 新质押被阻止
  - 如果满足解锁条件，可以正常解除质押但奖励为 0；如果未到期，可以使用紧急提取（仅本金）

**使用场景**：
- 合约紧急情况或安全风险
- 需要快速回收用户本金
- 系统维护或升级
- 不可预见的紧急情况

**操作流程**：
1. 管理员启用紧急模式
2. 系统通知用户紧急模式已启用
3. 用户可以选择紧急提取（提取本金，放弃奖励）
4. 紧急情况解决后，管理员可以禁用紧急模式

**运营建议**：
- ⚠️ 谨慎使用紧急模式，仅在真正紧急情况下启用
- ⚠️ 及时通知所有用户紧急模式已启用
- ⚠️ 制定详细的紧急处理程序
- ⚠️ 明确告知用户紧急提取会放弃奖励
- ⚠️ 确保用户充分理解紧急提取的后果

---

## 五. 运营策略建议

### 运营策略

1. **用户获取**
   - 强调低门槛（1 HSK 即可参与）
   - 突出稳定收益（5% 基础 APY，总预期 Up to 8%）
   - 降低参与难度（默认无需审核）
   - 推广忠诚度补贴（1%-3% 额外 APY）

2. **用户留存**
   - 锁定期为 365 天
   - 支持提前解除质押（需支付罚金）
   - 定期发布收益报告
   - 建设用户社区

3. **奖励池管理**
   - 定期监控奖励池余额
   - 提前规划充值计划
   - 确保及时奖励分发
   - 基于 5% 基础 APY 计算

4. **罚金池管理**
   - 监控罚金池累积情况
   - 活动结束后规划分配
   - 确保公平分配给完整质押用户

5. **忠诚度补贴管理**
   - 监控忠诚度补贴计算
   - 活动结束后规划分配（与罚金池相同）
   - 根据质押金额确保公平分配给完整质押用户

---

## 六. 关键指标监控

### 质押监控指标

- **总质押量**：监控产品总质押金额
- **用户数量**：统计参与用户数
- **平均质押金额**：了解用户质押规模
- **奖励池余额**：确保有足够资金支付奖励
- **总待发放奖励**：监控 totalPendingRewards，确保奖励池余额充足
- **罚金池余额**：监控罚金池累积情况
- **提前解除质押申请数**：跟踪提前解除质押申请数量

---

## 七. 运营注意事项

### 1. 奖励池管理
- ✅ 产品需要奖励池
- ✅ 定期检查奖励池余额
- ✅ 提前规划充值计划
- ⚠️ 确保有足够资金支付奖励（基于 5% 基础 APY）

### 2. 白名单管理（如果启用）
- ✅ 建立审核标准
- ✅ 定期审查白名单用户
- ✅ 及时添加/移除用户
- ⚠️ 确保审核过程透明

### 3. 用户沟通
- ✅ 及时发布产品信息
- ✅ 解答用户疑问
- ✅ 提供使用指南
- ⚠️ 保持沟通渠道畅通

### 4. 风险控制
- ✅ 监控产品总质押量和奖励池余额
- ✅ 关注异常情况（奖励池余额不足、紧急模式等）
- ✅ 制定应急预案
- ⚠️ 确保系统稳定运行
- ⚠️ 定期检查奖励池余额是否足够支付所有待发放奖励

---

## 八. 总结

HSK Staking 产品方案为所有用户提供单一质押池：

- **单一池子**：低门槛（1 HSK），稳定收益（5% 基础 APY，总预期 Up to 8%），对所有用户开放
- **提前解除质押**：支持（50% 罚金，7 天等待期）
- **罚金池**：活动结束后分配给完成完整质押周期的用户

通过合理的机制设计，确保产品安全性并提供灵活的用户体验，为运营提供清晰的运营策略和监控指标。

---

## 📚 相关文档

- [主 README](../README.md)
- [合约架构说明](./CONTRACT_ARCHITECTURE.md) - **合约架构详解（开发必读）**
- [产品摘要](./PRODUCT_SUMMARY.md) - 快速了解
- [单层产品方案文档](./DUAL_TIER_STAKING.md) - 技术部署文档
- [产品开发文档](./PRODUCT_PLANS_DEV.md) - 开发团队文档
- [快速开始指南](./QUICK_START_DUAL_TIER.md) - 快速部署指南
- [技术 FAQ](./TECHNICAL_FAQ.md) - 技术机制说明
- [错误处理指南](./ERROR_HANDLING.md) - 常见错误处理

---

**文档版本**: 1.0.0  
**维护者**: HashKey 技术团队
